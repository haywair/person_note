### mysql分层

* mysql大体分为Server层和存储引擎层两部分
* server层细分(mysql的核心服务功能，以及所有的内置函数)：
  1. 连接器：连接数据库   mysql -h$ip -P$port -u$user -p

```
* 解决长连接导致内存占用过大，mysql异常重启方法：
1.定期断开长连接。使用一段时间后，或者程序里面之行一个占用内存过大的查询后，断开连接，之后要查询重新连接
2.如果用的是mysql5.7或更新版本，可以做每次之行一个比较大的操作后，通过执行mysql_reset_connection来重新初始化连接资源
```

​	2.查询缓存

```
大多数情况下，不建议使用查询缓存
如需指定缓存，命令类似如下：
select SQL_CACHE * form T where id = 10

mysql8.0已将查询缓存的整块功能去掉了
```

 3. 分析器

    分析器会先做词法分析，识别字符串分别是什么，代表什么。

    做完词法分析后会做语法分析，查看输入的sql语句是否满足mysql语法

4. 优化器

   存在多个索引是，会决定使用哪个索引，存在多个关联语句时，决定各个表的连接顺序。

5. 执行器

   首先判断有无执行权限，有权限则打开表继续执行

6. 数据库慢查询日志中看到一个rows_examined字段，表示这个语句执行过程中扫描了多少行。

